# 使い方ガイド

レシピ原価計算Botの詳しい使い方を説明します。

## 📱 LINEでの操作

### 基本コマンド

#### ヘルプ表示
```
ヘルプ
```
または
```
help
```

使い方の一覧が表示されます。

---

## 📸 レシピ解析

### 画像を送信

1. レシピが写っている画像を撮影または用意
2. LINE Botに画像を送信
3. 自動的に以下の処理が実行されます：
   - Azure Vision APIでOCR（文字認識）
   - GroqのLLMでレシピ情報を構造化
   - 原価表を参照して材料ごとに原価を計算
   - Supabaseにレシピを保存
   - 合計原価をLINEで返信

### レシピ画像の推奨形式

- **文字が鮮明に写っている**こと
- **料理名**が記載されている
- **材料と分量**が明確に記載されている
- **何人前**か記載されている（推奨）

### 例

```
カレー（2人前）

材料:
玉ねぎ 1個
にんじん 1本
じゃがいも 2個
豚肉 200g
カレールウ 4皿分
水 400ml
```

このような画像を送信すると、自動的に解析され、以下のような返信が来ます：

```
【カレー】
(2人前)

【材料と原価】
・玉ねぎ 1個 - ¥50.00
・にんじん 1本 - ¥80.00
・じゃがいも 2個 - ¥80.00
・豚肉 200g - ¥600.00
・カレールウ 4皿分 - 未登録
・水 400ml - 未登録

【合計原価】¥810.00
【1人前原価】¥405.00

※未登録材料: カレールウ, 水
```

---

## 💰 原価表管理

### 原価を追加

自然な日本語で材料と価格を入力できます。

#### 基本形式
```
追加 材料名 価格/単位
```

#### 例

**個数単位:**
```
追加 トマト 100円/個
追加 玉ねぎ 50円/個
追加 卵 30円/個
```

**重量単位:**
```
追加 豚肉 300円/100g
追加 鶏むね肉 250円/100g
追加 牛ひき肉 500円/100g
```

**容量単位:**
```
追加 牛乳 200円/1L
追加 醤油 300円/1L
追加 サラダ油 400円/500ml
```

**その他:**
```
追加 キャベツ1玉150円
追加 豆腐1丁80円
追加 もやし1袋30円
```

#### 返信例
```
✅ 原価表に登録しました

【材料名】トマト
【単価】¥100.00
【基準】1個あたり
```

### 原価を確認

登録されている材料の価格を確認できます。

```
確認 材料名
```

#### 例
```
確認 トマト
```

#### 返信例
```
📋 原価情報

【材料名】トマト
【単価】¥100.00
【基準】1個あたり
【更新日】2025-10-12T10:30:00
```

### 原価を削除

不要になった材料を削除できます。

```
削除 材料名
```

#### 例
```
削除 トマト
```

#### 返信例
```
✅ 「トマト」を原価表から削除しました。
```

### 原価一覧

登録されている全材料を表示します。

```
原価一覧
```
または
```
一覧
```

#### 返信例
```
📋 原価一覧（20件）

1. トマト
   ¥100/1個
2. にんじん
   ¥80/1本
3. 玉ねぎ
   ¥50/1個
4. 豚肉
   ¥300/100g
...
```

---

## 🔄 ワークフロー例

### シナリオ1: 新しいレシピの原価計算

1. レシピ画像を撮影
2. LINE Botに送信
3. 「未登録材料」があった場合：
   ```
   追加 カレールウ 200円/4皿分
   追加 水 0円/1L
   ```
4. もう一度レシピ画像を送信
5. 正確な原価が計算される

### シナリオ2: 価格変動への対応

1. スーパーで買い物
2. 価格が変わっていた材料を更新：
   ```
   追加 豚肉 350円/100g
   ```
   （既存の材料は自動的に更新されます）
3. 次回から新しい価格で計算される

### シナリオ3: 原価一覧の確認

1. どんな材料が登録されているか確認：
   ```
   原価一覧
   ```
2. 特定の材料の詳細を確認：
   ```
   確認 豚肉
   ```

---

## 💡 ヒント

### 材料名について

- 原価表に登録した**材料名と完全一致**する必要があります
- 例:
  - 原価表: 「豚肉」
  - レシピ: 「豚バラ肉」→ 一致しない ❌
  - レシピ: 「豚肉」→ 一致する ✅

### よくある材料の登録例

```
追加 玉ねぎ 50円/個
追加 にんじん 80円/本
追加 じゃがいも 40円/個
追加 豚肉 300円/100g
追加 鶏肉 250円/100g
追加 牛肉 500円/100g
追加 卵 30円/個
追加 牛乳 200円/1L
追加 バター 400円/200g
追加 小麦粉 150円/1kg
追加 砂糖 200円/1kg
追加 塩 100円/1kg
追加 醤油 300円/1L
追加 味噌 400円/1kg
追加 サラダ油 300円/1L
追加 米 2000円/5kg
追加 トマト 100円/個
追加 キャベツ 150円/玉
追加 もやし 30円/袋
追加 豆腐 80円/丁
```

### 単位変換

以下の単位は自動的に変換されます：

**重量:**
- kg ↔ g ↔ mg

**容量:**
- L (リットル) ↔ ml ↔ cc
- 大さじ = 15ml
- 小さじ = 5ml
- カップ = 200ml

---

## ⚠️ 注意事項

### OCRの精度

- 手書き文字は認識精度が低下する場合があります
- できるだけ印刷されたテキストや明瞭な文字を使用してください
- 照明が暗い場合は認識精度が低下します

### 材料名のゆれ

- 「豚肉」「豚バラ肉」「豚ロース」は別の材料として扱われます
- より詳細な材料名で登録することをお勧めします

### 原価の更新

- 原価を更新した場合、**過去のレシピの原価は変更されません**
- 新しく解析するレシピから新しい原価が適用されます

---

## 🎯 活用例

### 飲食店での活用

1. 新メニューの原価計算
2. 既存メニューの原価見直し
3. 仕入れ価格変動の管理

### 家庭での活用

1. 毎日の献立の原価把握
2. 節約レシピの比較
3. 食材の価格管理

### 料理教室での活用

1. レシピ開発時の原価計算
2. 生徒向けレシピの原価情報提供
3. 材料費の見積もり

---

## 📞 サポート

不明点がある場合は、`ヘルプ`と送信してください。

問題が発生した場合は、以下をご確認ください：
- Supabaseの原価表が正しく設定されているか
- 材料名が一致しているか
- 画像が鮮明に撮影されているか

---

**バージョン**: 2.0.0  
**最終更新**: 2025-10-12

